<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <DataSources>
    <DataSource Name="SQL1_DENVERAPP">
      <rd:DataSourceID>f4c3a66a-c6ed-415d-a199-2e9cf1750066</rd:DataSourceID>
      <DataSourceReference>SQL1_DENVERAPP</DataSourceReference>
    </DataSource>
  </DataSources>
  <rd:ReportID>34bb5171-96b7-45d7-ba06-5204fa62edcb</rd:ReportID>
  <Width>13in</Width>
  <Body>
    <Height>0.63in</Height>
    <ColumnSpacing>0.5in</ColumnSpacing>
    <ReportItems>
      <Textbox Name="textbox1">
        <rd:DefaultName>textbox1</rd:DefaultName>
        <Value>Invoice Register Report</Value>
        <Style>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
        <CanGrow>true</CanGrow>
        <Height>0.21in</Height>
      </Textbox>
      <Table Name="table1">
        <Top>0.21in</Top>
        <Header>
          <RepeatOnNewPage>true</RepeatOnNewPage>
          <TableRows>
            <TableRow>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox2">
                      <rd:DefaultName>textbox2</rd:DefaultName>
                      <Value>Company</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox3">
                      <rd:DefaultName>textbox3</rd:DefaultName>
                      <Value>Project ID</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox4">
                      <rd:DefaultName>textbox4</rd:DefaultName>
                      <Value>Bat Nbr</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox5">
                      <rd:DefaultName>textbox5</rd:DefaultName>
                      <Value>Ref Nbr</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox6">
                      <rd:DefaultName>textbox6</rd:DefaultName>
                      <Value>Invoice Num</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox7">
                      <rd:DefaultName>textbox7</rd:DefaultName>
                      <Value>invoice date</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox8">
                      <rd:DefaultName>textbox8</rd:DefaultName>
                      <Value>Invoice Amount</Value>
                      <Style>
                        <TextAlign>Right</TextAlign>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox9">
                      <rd:DefaultName>textbox9</rd:DefaultName>
                      <Value>Cust Code</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox10">
                      <rd:DefaultName>textbox10</rd:DefaultName>
                      <Value>Cust Name</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox11">
                      <rd:DefaultName>textbox11</rd:DefaultName>
                      <Value>Product Code</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox12">
                      <rd:DefaultName>textbox12</rd:DefaultName>
                      <Value>Product</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox13">
                      <rd:DefaultName>textbox13</rd:DefaultName>
                      <Value>Projuct Desc</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="textbox14">
                      <rd:DefaultName>textbox14</rd:DefaultName>
                      <Value>crtd user</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
              <Height>0.21in</Height>
            </TableRow>
          </TableRows>
        </Header>
        <Details>
          <TableRows>
            <TableRow>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Company">
                      <rd:DefaultName>Company</rd:DefaultName>
                      <Value>=Fields!Company.Value</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="ProjectID">
                      <rd:DefaultName>ProjectID</rd:DefaultName>
                      <Value>=Fields!ProjectID.Value</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="BatNbr">
                      <rd:DefaultName>BatNbr</rd:DefaultName>
                      <Value>=Fields!BatNbr.Value</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="RefNbr">
                      <rd:DefaultName>RefNbr</rd:DefaultName>
                      <Value>=Fields!RefNbr.Value</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="InvoiceNum">
                      <rd:DefaultName>InvoiceNum</rd:DefaultName>
                      <Value>=Fields!InvoiceNum.Value</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="invoice_date">
                      <rd:DefaultName>invoice_date</rd:DefaultName>
                      <Value>=Fields!invoice_date.Value</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="InvoiceAmount">
                      <rd:DefaultName>InvoiceAmount</rd:DefaultName>
                      <Value>=Fields!InvoiceAmount.Value</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="CustCode">
                      <rd:DefaultName>CustCode</rd:DefaultName>
                      <Value>=Fields!CustCode.Value</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="CustName">
                      <rd:DefaultName>CustName</rd:DefaultName>
                      <Value>=Fields!CustName.Value</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="ProductCode">
                      <rd:DefaultName>ProductCode</rd:DefaultName>
                      <Value>=Fields!ProductCode.Value</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Product">
                      <rd:DefaultName>Product</rd:DefaultName>
                      <Value>=Fields!Product.Value</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="ProjuctDesc">
                      <rd:DefaultName>ProjuctDesc</rd:DefaultName>
                      <Value>=Fields!ProjuctDesc.Value</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="crtd_user">
                      <rd:DefaultName>crtd_user</rd:DefaultName>
                      <Value>=Fields!crtd_user.Value</Value>
                      <Style>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                      <CanGrow>true</CanGrow>
                      <Height>0.21in</Height>
                      <Width>1in</Width>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
              <Height>0.21in</Height>
            </TableRow>
          </TableRows>
        </Details>
        <TableColumns>
          <TableColumn>
            <Width>1in</Width>
          </TableColumn>
          <TableColumn>
            <Width>1in</Width>
          </TableColumn>
          <TableColumn>
            <Width>1in</Width>
          </TableColumn>
          <TableColumn>
            <Width>1in</Width>
          </TableColumn>
          <TableColumn>
            <Width>1in</Width>
          </TableColumn>
          <TableColumn>
            <Width>1in</Width>
          </TableColumn>
          <TableColumn>
            <Width>1in</Width>
          </TableColumn>
          <TableColumn>
            <Width>1in</Width>
          </TableColumn>
          <TableColumn>
            <Width>1in</Width>
          </TableColumn>
          <TableColumn>
            <Width>1in</Width>
          </TableColumn>
          <TableColumn>
            <Width>1in</Width>
          </TableColumn>
          <TableColumn>
            <Width>1in</Width>
          </TableColumn>
          <TableColumn>
            <Width>1in</Width>
          </TableColumn>
        </TableColumns>
        <DataSetName>DataSet1</DataSetName>
      </Table>
    </ReportItems>
  </Body>
  <Language>en-US</Language>
  <LeftMargin>1in</LeftMargin>
  <RightMargin>1in</RightMargin>
  <TopMargin>1in</TopMargin>
  <BottomMargin>1in</BottomMargin>
  <PageWidth>8.5in</PageWidth>
  <PageHeight>11in</PageHeight>
  <DataSets>
    <DataSet Name="DataSet1">
      <Fields>
        <Field Name="Company">
          <DataField>Company</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ProjectID">
          <DataField>ProjectID</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="BatNbr">
          <DataField>BatNbr</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="RefNbr">
          <DataField>RefNbr</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Module">
          <DataField>Module</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="JrnlType">
          <DataField>JrnlType</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="BatMod">
          <DataField>BatMod</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="invoice_date">
          <DataField>invoice_date</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="InvoiceAmount">
          <DataField>InvoiceAmount</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
        <Field Name="InvoiceNum">
          <DataField>InvoiceNum</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CustCode">
          <DataField>CustCode</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CustName">
          <DataField>CustName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ProjuctDesc">
          <DataField>ProjuctDesc</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ProductCode">
          <DataField>ProductCode</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Product">
          <DataField>Product</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="crtd_user">
          <DataField>crtd_user</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>SQL1_DENVERAPP</DataSourceName>
        <CommandType>Text</CommandType>
        <CommandText>declare @begTime datetime
declare @endTime datetime
declare @begin datetime
declare @end datetime

/*
declare @begDate date
declare @endDate date
set @begDate = '2/1/2013'
set @endDate = '2/28/2013'
*/

set @begTime = '12:00:00 AM'
set @endTime = '11:59:59 PM'

--set @sEmp_ID = ''
set @begin = Convert(datetime, Convert(char(10), @begDate, 103) + ' ' + Convert(char(8), @begTime, 108), 103)
set @end = Convert(datetime, Convert(char(10), @endDate, 103) + ' ' + Convert(char(8), @endTime, 108), 103)


Select a.* from (
-- Denver Company
SELECT DISTINCT 'DENVER' as Company
, gl.ProjectID AS ProjectID
, gl.BatNbr AS BatNbr
, gl.RefNbr AS RefNbr
, gl.Module
, gl.JrnlType
, b.Module as BatMod
, h.invoice_date
, h.gross_amt AS InvoiceAmount
, h.invoice_num AS InvoiceNum
, p.pm_id01 AS CustCode
, c.Name AS CustName
, p.project_desc AS ProjuctDesc
, p.pm_id02 AS ProductCode
, pc.code_value_desc AS Product
, h.crtd_user
FROM DENVERAPP.dbo.GLTran gl
INNER JOIN DENVERAPP.dbo.Batch b ON gl.BatNbr = b.BatNbr 
INNER JOIN DENVERAPP.dbo.PJINVHDR h ON gl.BatNbr = h.batch_id AND gl.RefNbr = h.invoice_num 
INNER JOIN DENVERAPP.dbo.PJPROJ p ON h.project_billwith = p.project 
LEFT OUTER JOIN DENVERAPP.dbo.PJCODE pc ON p.pm_id02 = pc.code_value AND pc.code_type = 'BCYC' 
LEFT OUTER JOIN DENVERAPP.dbo.Customer c ON p.pm_id01 = c.CustId
UNION ALL
-- Midwest company
SELECT DISTINCT 'MIDWEST' as Company
, gl.ProjectID AS ProjectID
, gl.BatNbr AS BatNbr
, gl.RefNbr AS RefNbr
, gl.Module
, gl.JrnlType
, b.Module as BatMod
, h.invoice_date
, h.gross_amt AS InvoiceAmount
, h.invoice_num AS InvoiceNum
, p.pm_id01 AS CustCode
, c.Name AS CustName
, p.project_desc AS ProjuctDesc
, p.pm_id02 AS ProductCode
, pc.code_value_desc AS Product
, h.crtd_user
FROM MIDWESTAPP.dbo.GLTran gl
INNER JOIN MIDWESTAPP.dbo.Batch b ON gl.BatNbr = b.BatNbr 
INNER JOIN MIDWESTAPP.dbo.PJINVHDR h ON gl.BatNbr = h.batch_id AND gl.RefNbr = h.invoice_num 
INNER JOIN MIDWESTAPP.dbo.PJPROJ p ON h.project_billwith = p.project 
LEFT OUTER JOIN MIDWESTAPP.dbo.PJCODE pc ON p.pm_id02 = pc.code_value AND pc.code_type = 'BCYC' 
LEFT OUTER JOIN MIDWESTAPP.dbo.Customer c ON p.pm_id01 = c.CustId
UNION ALL
-- New York company
SELECT DISTINCT 'NEWYORK' as Company
, gl.ProjectID AS ProjectID
, gl.BatNbr AS BatNbr
, gl.RefNbr AS RefNbr
, gl.Module
, gl.JrnlType
, b.Module as BatMod
, h.invoice_date
, h.gross_amt AS InvoiceAmount
, h.invoice_num AS InvoiceNum
, p.pm_id01 AS CustCode
, c.Name AS CustName
, p.project_desc AS ProjuctDesc
, p.pm_id02 AS ProductCode
, pc.code_value_desc AS Product
, h.crtd_user
FROM NEWYORKAPP.dbo.GLTran gl
INNER JOIN NEWYORKAPP.dbo.Batch b ON gl.BatNbr = b.BatNbr 
INNER JOIN NEWYORKAPP.dbo.PJINVHDR h ON gl.BatNbr = h.batch_id AND gl.RefNbr = h.invoice_num 
INNER JOIN NEWYORKAPP.dbo.PJPROJ p ON h.project_billwith = p.project 
LEFT OUTER JOIN NEWYORKAPP.dbo.PJCODE pc ON p.pm_id02 = pc.code_value AND pc.code_type = 'BCYC' 
LEFT OUTER JOIN NEWYORKAPP.dbo.Customer c ON p.pm_id01 = c.CustId
UNION ALL
-- LA company
SELECT DISTINCT 'LA' as Company
, gl.ProjectID AS ProjectID
, gl.BatNbr AS BatNbr
, gl.RefNbr AS RefNbr
, gl.Module
, gl.JrnlType
, b.Module as BatMod
, h.invoice_date
, h.gross_amt AS InvoiceAmount
, h.invoice_num AS InvoiceNum
, p.pm_id01 AS CustCode
, c.Name AS CustName
, p.project_desc AS ProjuctDesc
, p.pm_id02 AS ProductCode
, pc.code_value_desc AS Product
, h.crtd_user
FROM LAAPP.dbo.GLTran gl
INNER JOIN LAAPP.dbo.Batch b ON gl.BatNbr = b.BatNbr 
INNER JOIN LAAPP.dbo.PJINVHDR h ON gl.BatNbr = h.batch_id AND gl.RefNbr = h.invoice_num 
INNER JOIN LAAPP.dbo.PJPROJ p ON h.project_billwith = p.project 
LEFT OUTER JOIN LAAPP.dbo.PJCODE pc ON p.pm_id02 = pc.code_value AND pc.code_type = 'BCYC' 
LEFT OUTER JOIN LAAPP.dbo.Customer c ON p.pm_id01 = c.CustId
)a 
WHERE a.Module = 'BI' 
AND a.JrnlType &lt;&gt; 'REV' 
AND a.BatMod = 'BI'
AND a.invoice_date BETWEEN @begin AND @end
AND a.company IN (@sCompany)</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
        <QueryParameters>
          <QueryParameter Name="@begDate">
            <Value>=Parameters!begDate.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@endDate">
            <Value>=Parameters!endDate.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@sCompany">
            <Value>=Parameters!sCompany.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <Timeout>0</Timeout>
      </Query>
    </DataSet>
  </DataSets>
  <ReportParameters>
    <ReportParameter Name="begDate">
      <DataType>String</DataType>
      <Prompt>beg Date</Prompt>
    </ReportParameter>
    <ReportParameter Name="endDate">
      <DataType>String</DataType>
      <Prompt>end Date</Prompt>
    </ReportParameter>
    <ReportParameter Name="sCompany">
      <DataType>String</DataType>
      <Prompt>s Company</Prompt>
    </ReportParameter>
  </ReportParameters>
</Report>